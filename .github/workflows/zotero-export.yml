name: Zotero Bib Export

on:
  schedule:
    - cron: '0 12 * * *'  # täglich um 12:00 Uhr UTC
  workflow_dispatch:      # manuell auslösbar

jobs:
  export-bib:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v4

    - name: Set up Git
      run: |
        git config --global user.name "github-actions[bot]"
        git config --global user.email "github-actions[bot]@users.noreply.github.com"

    - name: Download latest BibTeX from Zotero
      run: |
        curl -L -o path/to/literatur.bib "https://api.zotero.org/groups/${{ secrets.ZOTERO_GROUP_ID }}/items?format=bibtex&key=${{ secrets.ZOTERO_API_KEY }}"

    - name: Commit changes
      run: |
        git add path/to/literatur.bib
        git commit -m "Automatisches Update der .bib-Datei von Zotero" || echo "Keine Änderungen zum Commit"
    
    - name: Push changes
      run: git push origin HEAD
